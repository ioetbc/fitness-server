=== IMPLEMENTATION PROGRESS ===

[✓] Task 1: Add Unit Normalization to Logging Prompt
    Files: src/prompts/habit-tracking-prompts.ts, src/types/habit-schemas.ts
    - Added comprehensive unit normalization section to HABIT_LOGGING_SYSTEM_PROMPT
    - Defined standard units for distance, time, weight, volume, and count
    - Added Example 10 demonstrating unit normalization ("5k" → "km")
    - Created allowedUnits const array with all normalized values
    - Updated habitLogParseSchema, createHabitLogSchema, habitLogResponseSchema to use z.enum(allowedUnits)
    - Two-layer validation: LLM prompt guides + Zod schema enforces
    Commit: 1ad1979

[✓] Task 2: Fix Query Prompt - Add Existing Habits Context
    Files: src/prompts/habit-tracking-prompts.ts, src/routes/habits.ts
    - Added "CRITICAL: Semantic Habit Matching" section to HABIT_QUERY_SYSTEM_PROMPT
    - Updated buildQueryPrompt() signature to accept existingHabits parameter
    - Added logic to format existing habits list in prompt
    - Updated /query route to fetch existing habits from database
    - Now LLM can map "have a drink" → "drinking" habit
    Commit: c369b92

[✓] Task 3: Fix Query Prompt - Add Quantity Aggregation Guidance
    Files: src/prompts/habit-tracking-prompts.ts
    - Added "Aggregate Queries" section to HABIT_QUERY_SYSTEM_PROMPT
    - Explained that "how many kilometers" queries need to sum quantity field
    - Added example response: "You've run 42 kilometers across 6 runs..."
    - Now LLM knows to sum quantities instead of counting occurrences
    Commit: dfb1a3d

[✓] Task 4: Fix Query Prompt - Add Longest Streak Guidance
    Files: src/prompts/habit-tracking-prompts.ts
    - Updated streak query examples to include longest streak
    - Added "what's the longest I've gone without drinking" example
    - Clarified that getHabitStatsTool returns both current AND longest streaks
    - Added example response showing longest streak with current comparison
    Commit: 1214a53

=== ALL TASKS COMPLETE ===

Summary of changes:
1. Unit normalization enforced via prompt + Zod schemas
2. Semantic habit matching with existing habits context
3. Aggregate query guidance for summing quantities
4. Longest streak query support

Ready for testing with:
- "when did I last have a drink" → should map to "drinking" habit
- "how many kilometers have I run" → should sum quantities
- "what's the longest I've gone without drinking" → should show longest streak
- "I ran 5k" → should normalize to unit: "km"
